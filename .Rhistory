Undergraduate.application.fee + Num.of.Office.and.Administrative.Support +
Num.of.Natural.Resources..Construction..and.Maintenance +
Average.9.month.salary.full.time.all.ranks + Average.9.month.salary.full.time.associate.professors +
Average.amount.of.federal..state..local.or.institutional.grant.aid.received +
Average.amount.of.federal.grant.aid.received.by.full.time.first.time.undergraduates, data=train)
summary(m10)
m10 <- lm(y_trans ~ Total.price.for.in.state.students.living.off.campus..with.family. +
Undergraduate.enrollment + first.time.degree.certificate.seeking.undergraduate.enrollment +
full.time.undergraduate.enrollment + Student.to.faculty.ratio +
full.time.retention.rate + Tuition.and.fees + Applicants.men +
Enrolled.full.time.men +
Undergraduate.application.fee + Num.of.Office.and.Administrative.Support +
Num.of.Natural.Resources..Construction..and.Maintenance +
Average.9.month.salary.full.time.all.ranks + Average.9.month.salary.full.time.associate.professors +
Average.amount.of.federal..state..local.or.institutional.grant.aid.received +
Average.amount.of.federal.grant.aid.received.by.full.time.first.time.undergraduates, data=train)
summary(m10)
m10 <- lm(y_trans ~ Total.price.for.in.state.students.living.off.campus..with.family. +
Undergraduate.enrollment + first.time.degree.certificate.seeking.undergraduate.enrollment +
full.time.undergraduate.enrollment + Student.to.faculty.ratio +
full.time.retention.rate +
Undergraduate.application.fee + Num.of.Office.and.Administrative.Support +
Num.of.Natural.Resources..Construction..and.Maintenance +
Average.9.month.salary.full.time.all.ranks + Average.9.month.salary.full.time.associate.professors +
Average.amount.of.federal..state..local.or.institutional.grant.aid.received +
Average.amount.of.federal.grant.aid.received.by.full.time.first.time.undergraduates, data=train)
summary(m10)
m10 <- lm(y_trans ~ Total.price.for.in.state.students.living.off.campus..with.family. +
Undergraduate.enrollment + first.time.degree.certificate.seeking.undergraduate.enrollment +
full.time.undergraduate.enrollment + Student.to.faculty.ratio +
full.time.retention.rate + Tuition.and.fees + Applicants.men +
Undergraduate.application.fee + Num.of.Office.and.Administrative.Support +
Num.of.Natural.Resources..Construction..and.Maintenance +
Average.9.month.salary.full.time.all.ranks + Average.9.month.salary.full.time.associate.professors +
Average.amount.of.federal..state..local.or.institutional.grant.aid.received +
Average.amount.of.federal.grant.aid.received.by.full.time.first.time.undergraduates, data=train)
summary(m10)
m10 <- lm(y_trans ~ Total.price.for.in.state.students.living.off.campus..with.family. +
Undergraduate.enrollment + first.time.degree.certificate.seeking.undergraduate.enrollment +
full.time.undergraduate.enrollment + Student.to.faculty.ratio +
full.time.retention.rate + Tuition.and.fees + Applicants.men +
Undergraduate.application.fee + Num.of.Office.and.Administrative.Support +
Num.of.Natural.Resources..Construction..and.Maintenance +
Average.9.month.salary.full.time.all.ranks +
Average.amount.of.federal..state..local.or.institutional.grant.aid.received +
Average.amount.of.federal.grant.aid.received.by.full.time.first.time.undergraduates, data=train)
summary(m10)
m10 <- lm(y_trans ~ Total.price.for.in.state.students.living.off.campus..with.family. +
Undergraduate.enrollment + first.time.degree.certificate.seeking.undergraduate.enrollment +
full.time.undergraduate.enrollment +
full.time.retention.rate + Tuition.and.fees + Applicants.men +
Undergraduate.application.fee + Num.of.Office.and.Administrative.Support +
Num.of.Natural.Resources..Construction..and.Maintenance +
Average.9.month.salary.full.time.all.ranks +
Average.amount.of.federal..state..local.or.institutional.grant.aid.received +
Average.amount.of.federal.grant.aid.received.by.full.time.first.time.undergraduates, data=train)
summary(m10)
m10 <- lm(y_trans ~ Total.price.for.in.state.students.living.off.campus..with.family. +
Undergraduate.enrollment + first.time.degree.certificate.seeking.undergraduate.enrollment +
full.time.undergraduate.enrollment +
full.time.retention.rate + Tuition.and.fees +
Undergraduate.application.fee + Num.of.Office.and.Administrative.Support +
Num.of.Natural.Resources..Construction..and.Maintenance +
Average.9.month.salary.full.time.all.ranks +
Average.amount.of.federal..state..local.or.institutional.grant.aid.received +
Average.amount.of.federal.grant.aid.received.by.full.time.first.time.undergraduates, data=train)
summary(m10)
m10 <- lm(y_trans ~ Total.price.for.in.state.students.living.off.campus..with.family. +
Undergraduate.enrollment + first.time.degree.certificate.seeking.undergraduate.enrollment +
full.time.undergraduate.enrollment +
full.time.retention.rate + Tuition.and.fees +
Undergraduate.application.fee + Num.of.Office.and.Administrative.Support +
Num.of.Natural.Resources..Construction..and.Maintenance +
Average.9.month.salary.full.time.all.ranks +
Average.amount.of.federal.grant.aid.received.by.full.time.first.time.undergraduates, data=train)
summary(m10)
m10 <- lm(y_trans ~
Undergraduate.enrollment + first.time.degree.certificate.seeking.undergraduate.enrollment +
full.time.undergraduate.enrollment +
full.time.retention.rate + Tuition.and.fees +
Undergraduate.application.fee + Num.of.Office.and.Administrative.Support +
Num.of.Natural.Resources..Construction..and.Maintenance +
Average.9.month.salary.full.time.all.ranks +
Average.amount.of.federal.grant.aid.received.by.full.time.first.time.undergraduates, data=train)
summary(m10)
train$Total.priceSQ <- train$Total.price.for.in.state.students.living.off.campus..not.with.family. ** 2
m10 <- lm(y_trans ~
Undergraduate.enrollment + first.time.degree.certificate.seeking.undergraduate.enrollment +
full.time.undergraduate.enrollment +
full.time.retention.rate + Tuition.and.fees +
Undergraduate.application.fee + Num.of.Office.and.Administrative.Support +
Num.of.Natural.Resources..Construction..and.Maintenance +
Average.9.month.salary.full.time.all.ranks + Total.priceSQ
Average.amount.of.federal.grant.aid.received.by.full.time.first.time.undergraduates, data=train)
summary(m10)
m10 <- lm(y_trans ~
Undergraduate.enrollment + first.time.degree.certificate.seeking.undergraduate.enrollment +
full.time.undergraduate.enrollment +
full.time.retention.rate + Tuition.and.fees +
Undergraduate.application.fee + Num.of.Office.and.Administrative.Support +
Num.of.Natural.Resources..Construction..and.Maintenance +
Average.9.month.salary.full.time.all.ranks + Total.priceSQ + Total.price.for.in.state.students.living.off.campus..not.with.family.
Average.amount.of.federal.grant.aid.received.by.full.time.first.time.undergraduates, data=train)
summary(m10)
m9 <- lm(y_trans ~ Total.price.for.in.state.students.living.off.campus..not.with.family. + full.time.retention.rate +
Total.priceSQ + Total.enrollment + Applicants.men, data=train)
summary(m9)
education <- read.csv("~/DePaul/CSC423_Regression/edu.csv")
education <- subset(education, education$Graduation.rate.men != 0)
education$Graduation.rate.men <- education$Graduation.rate.men/100
set.seed(123)
sample.size <- floor(0.7*nrow(education))
train.ind <- sample(seq_len(nrow(education)), size=sample.size)
train <- education[train.ind, ]
test <- education[-train.ind, ]
m1 <- lm(Graduation.rate.men ~ . - Graduation.rate.total.cohort - unitid - institution.name - year - City.location.of.institution - State.abbreviation
- Highest.level.of.offering - Institution.size.category - Bachelors.degree.awarded - Graduation.rate.American.Indian.or.Alaska.Native -
Graduation.rate.Black.non.Hispanic - Graduation.rate.Black.non.Hispanic - Graduation.rate.White.non.Hispanic -
Graduation.rate.women - Graduation.rate.Asian - Graduation.rate.Hispanic -
Number.of.students.receiving.a.Bachelors.degree - Graduation.rate.Asian.Native.Hawaiian.Other.Pacific.Islander -
Bachelors.degree, data=train)
summary(m1)
sqrt(train$Graduation.rate.men)
asin(sqrt(train$Graduation.rate.men))
train$y_trans <- log(train$Graduation.rate.men)
train$Total.priceSQ <- train$Total.price.for.in.state.students.living.off.campus..not.with.family. ** 2
m9 <- lm(y_trans ~ Total.price.for.in.state.students.living.off.campus..not.with.family. + full.time.retention.rate +
Total.priceSQ + Total.enrollment + Applicants.men, data=train)
summary(m9)
plot(m8$fitted.values, m8$residuals)
plot(train$Total.price.for.in.state.students.living.off.campus..not.with.family., m8$residuals)
plot(train$full.time.retention.rate, m8$residuals)
plot(train$Student.to.faculty.ratio, m8$residuals)
plot(train$Average.9.month.salary.full.time.professors, m8$residuals)
plot(train$Graduation.rate.women, m8$residuals)
education <- na.omit(education)
education <- read.csv("~/DePaul/CSC423_Regression/edu.csv")
education <- subset(education, education$Graduation.rate.men != 0)
education$Graduation.rate.men <- education$Graduation.rate.men/100
education <- na.omit(education)
set.seed(123)
sample.size <- floor(0.7*nrow(education))
train.ind <- sample(seq_len(nrow(education)), size=sample.size)
train <- education[train.ind, ]
test <- education[-train.ind, ]
m1 <- lm(Graduation.rate.men ~ . - Graduation.rate.total.cohort - unitid - institution.name - year - City.location.of.institution - State.abbreviation
- Highest.level.of.offering - Institution.size.category - Bachelors.degree.awarded - Graduation.rate.American.Indian.or.Alaska.Native -
Graduation.rate.Black.non.Hispanic - Graduation.rate.Black.non.Hispanic - Graduation.rate.White.non.Hispanic -
Graduation.rate.women - Graduation.rate.Asian - Graduation.rate.Hispanic -
Number.of.students.receiving.a.Bachelors.degree - Graduation.rate.Asian.Native.Hawaiian.Other.Pacific.Islander -
Bachelors.degree, data=train)
step <- stepAIC(m1, direction='backward')
m10 <- lm(y_trans ~ . - Graduation.rate.total.cohort - unitid - institution.name - year - City.location.of.institution - State.abbreviation
- Highest.level.of.offering - Institution.size.category - Bachelors.degree.awarded - Graduation.rate.American.Indian.or.Alaska.Native -
Graduation.rate.Black.non.Hispanic - Graduation.rate.Black.non.Hispanic - Graduation.rate.White.non.Hispanic -
Graduation.rate.women - Graduation.rate.Asian - Graduation.rate.Hispanic -
Number.of.students.receiving.a.Bachelors.degree - Graduation.rate.Asian.Native.Hawaiian.Other.Pacific.Islander -
Bachelors.degree, data=train)
sqrt(train$Graduation.rate.men)
asin(sqrt(train$Graduation.rate.men))
train$y_trans <- log(train$Graduation.rate.men)
train$Total.priceSQ <- train$Total.price.for.in.state.students.living.off.campus..not.with.family. ** 2
m10 <- lm(y_trans ~ . - Graduation.rate.total.cohort - unitid - institution.name - year - City.location.of.institution - State.abbreviation
- Highest.level.of.offering - Institution.size.category - Bachelors.degree.awarded - Graduation.rate.American.Indian.or.Alaska.Native -
Graduation.rate.Black.non.Hispanic - Graduation.rate.Black.non.Hispanic - Graduation.rate.White.non.Hispanic -
Graduation.rate.women - Graduation.rate.Asian - Graduation.rate.Hispanic -
Number.of.students.receiving.a.Bachelors.degree - Graduation.rate.Asian.Native.Hawaiian.Other.Pacific.Islander -
Bachelors.degree, data=train)
step <- stepAIC(m10, direction='backward')
m10 <- lm(y_trans ~ . - Graduation.rate.total.cohort - unitid - institution.name - year - City.location.of.institution - State.abbreviation
- Highest.level.of.offering - Institution.size.category - Bachelors.degree.awarded - Graduation.rate.American.Indian.or.Alaska.Native -
Graduation.rate.Black.non.Hispanic - Graduation.rate.Black.non.Hispanic - Graduation.rate.White.non.Hispanic -
Graduation.rate.women - Graduation.rate.Asian - Graduation.rate.Hispanic -
Number.of.students.receiving.a.Bachelors.degree - Graduation.rate.Asian.Native.Hawaiian.Other.Pacific.Islander -
Bachelors.degree - Graduation.rate.men, data=train)
step <- stepAIC(m10, direction='backward')
m11 <- lm(y_trans ~ Total.price.for.out.of.state.students.living.off.campus..not.with.family. +
Total.enrollment + full.time.enrollment + Undergraduate.enrollment +
full.time.undergraduate.enrollment + full.time.retention.rate +
Tuition.and.fees + Applicants.total + Enrolled.men + Enrolled.full.time.total +
Num.of.Community..SocialService..Legal..Arts..Design..Entertainment..Sports.and.Media +
Average.9.month.salary.full.time.professors + Average.amount.of.federal..state..local.or.institutional.grant.aid.received +
Total.priceSQ, data=train)
summary(m11)
m11 <- lm(y_trans ~ Total.price.for.out.of.state.students.living.off.campus..not.with.family. +
Total.enrollment + full.time.enrollment + Undergraduate.enrollment +
full.time.undergraduate.enrollment + full.time.retention.rate +
Tuition.and.fees + Applicants.total + Enrolled.men + Enrolled.full.time.total +
Average.9.month.salary.full.time.professors + Average.amount.of.federal..state..local.or.institutional.grant.aid.received +
Total.priceSQ, data=train)
summary(m11)
m11 <- lm(y_trans ~ Total.price.for.out.of.state.students.living.off.campus..not.with.family. +
Total.enrollment + full.time.enrollment + Undergraduate.enrollment +
full.time.undergraduate.enrollment + full.time.retention.rate +
Tuition.and.fees + Applicants.total + Enrolled.men +
Average.9.month.salary.full.time.professors + Average.amount.of.federal..state..local.or.institutional.grant.aid.received +
Total.priceSQ, data=train)
summary(m11)
m11 <- lm(y_trans ~ Total.price.for.out.of.state.students.living.off.campus..not.with.family. +
Total.enrollment + full.time.enrollment + Undergraduate.enrollment +
full.time.undergraduate.enrollment + full.time.retention.rate +
Tuition.and.fees + Applicants.total + Enrolled.full.time.total +
Average.9.month.salary.full.time.professors + Average.amount.of.federal..state..local.or.institutional.grant.aid.received +
Total.priceSQ, data=train)
summary(m11)
m11 <- lm(y_trans ~ Total.price.for.out.of.state.students.living.off.campus..not.with.family. +
Total.enrollment + full.time.enrollment + Undergraduate.enrollment +
full.time.undergraduate.enrollment + full.time.retention.rate +
Tuition.and.fees + Applicants.total +
Average.9.month.salary.full.time.professors + Average.amount.of.federal..state..local.or.institutional.grant.aid.received +
Total.priceSQ, data=train)
summary(m11)
m11 <- lm(y_trans ~ Total.price.for.out.of.state.students.living.off.campus..not.with.family. + full.time.enrollment + Undergraduate.enrollment +
full.time.undergraduate.enrollment + full.time.retention.rate +
Tuition.and.fees + Applicants.total + Enrolled.men +
Average.9.month.salary.full.time.professors + Average.amount.of.federal..state..local.or.institutional.grant.aid.received +
Total.priceSQ, data=train)
summary(m11)
m11 <- lm(y_trans ~ Total.price.for.out.of.state.students.living.off.campus..not.with.family. + full.time.enrollment + Undergraduate.enrollment +
full.time.undergraduate.enrollment + full.time.retention.rate +
Tuition.and.fees + Applicants.total +
Average.9.month.salary.full.time.professors + Average.amount.of.federal..state..local.or.institutional.grant.aid.received +
Total.priceSQ, data=train)
summary(m11)
m11 <- lm(y_trans ~ Total.price.for.out.of.state.students.living.off.campus..not.with.family. + full.time.enrollment + Undergraduate.enrollment +
full.time.undergraduate.enrollment + full.time.retention.rate +
Tuition.and.fees  +
Average.9.month.salary.full.time.professors + Average.amount.of.federal..state..local.or.institutional.grant.aid.received +
Total.priceSQ, data=train)
summary(m11)
m11 <- lm(y_trans ~ Total.price.for.out.of.state.students.living.off.campus..not.with.family. + Undergraduate.enrollment +
full.time.undergraduate.enrollment + full.time.retention.rate +
Tuition.and.fees  +
Average.9.month.salary.full.time.professors + Average.amount.of.federal..state..local.or.institutional.grant.aid.received +
Total.priceSQ, data=train)
summary(m11)
m11 <- lm(y_trans ~  Undergraduate.enrollment +
full.time.undergraduate.enrollment + full.time.retention.rate +
Tuition.and.fees  +
Average.9.month.salary.full.time.professors + Average.amount.of.federal..state..local.or.institutional.grant.aid.received +
Total.priceSQ, data=train)
summary(m11)
m11 <- lm(y_trans ~ Total.price.for.out.of.state.students.living.off.campus..not.with.family. + Undergraduate.enrollment +
full.time.retention.rate +
Tuition.and.fees  + Average.9.month.salary.full.time.professors +
Average.amount.of.federal..state..local.or.institutional.grant.aid.received + Total.priceSQ, data=train)
summary(m11)
m11 <- lm(y_trans ~ Total.price.for.out.of.state.students.living.off.campus..not.with.family. + Undergraduate.enrollment +
full.time.retention.rate +
Tuition.and.fees + Applicants.total + Enrolled.men +
Average.9.month.salary.full.time.professors + Average.amount.of.federal..state..local.or.institutional.grant.aid.received +
Total.priceSQ, data=train)
summary(m11)
m11 <- lm(y_trans ~ Total.price.for.out.of.state.students.living.off.campus..not.with.family. + Undergraduate.enrollment +
full.time.retention.rate +
Tuition.and.fees  + Enrolled.men +
Average.9.month.salary.full.time.professors + Average.amount.of.federal..state..local.or.institutional.grant.aid.received +
Total.priceSQ, data=train)
summary(m11)
m11 <- lm(y_trans ~ Total.price.for.out.of.state.students.living.off.campus..not.with.family. +
full.time.retention.rate +
Tuition.and.fees  + Enrolled.men +
Average.9.month.salary.full.time.professors + Average.amount.of.federal..state..local.or.institutional.grant.aid.received +
Total.priceSQ, data=train)
summary(m11)
m11 <- lm(y_trans ~ Total.price.for.out.of.state.students.living.off.campus..not.with.family. +
full.time.retention.rate +
Tuition.and.fees +
Average.9.month.salary.full.time.professors + Average.amount.of.federal..state..local.or.institutional.grant.aid.received +
Total.priceSQ, data=train)
summary(m11)
plot(train$full.time.retention.rate, m8$residuals)
plot(train$full.time.retention.rate, m11$residuals)
plot(train$Total.price.for.in.state.students.living.off.campus..not.with.family., m11$residuals)
plot(train$Student.to.faculty.ratio, m11$residuals)
plot(train$Average.9.month.salary.full.time.professors, m11$residuals)
train$ProfSQ <- train$Average.9.month.salary.full.time.professors ** 2
m11 <- lm(y_trans ~ Total.price.for.out.of.state.students.living.off.campus..not.with.family. +
full.time.retention.rate + ProfSQ +
Tuition.and.fees + Average.9.month.salary.full.time.professors +
Average.amount.of.federal..state..local.or.institutional.grant.aid.received + Total.priceSQ, data=train)
summary(m11)
plot(train$Average.9.month.salary.full.time.professors, m11$residuals)
plot(train$ProfSQ, m11$residuals)
m11 <- lm(y_trans ~ Total.price.for.out.of.state.students.living.off.campus..not.with.family. +
full.time.retention.rate +
Tuition.and.fees + Average.9.month.salary.full.time.professors +
Average.amount.of.federal..state..local.or.institutional.grant.aid.received + Total.priceSQ, data=train)
summary(m11)
plot(m8$fitted.values, m8$residuals)
plot(train$Total.price.for.in.state.students.living.off.campus..not.with.family., m11$residuals)
plot(train$full.time.retention.rate, m11$residuals)
plot(train$Student.to.faculty.ratio, m11$residuals)
plot(train$Average.9.month.salary.full.time.professors, m11$residuals)
m11 <- lm(y_trans ~ Total.price.for.out.of.state.students.living.off.campus..not.with.family. +
full.time.retention.rate +
Tuition.and.fees  +
Average.amount.of.federal..state..local.or.institutional.grant.aid.received + Total.priceSQ, data=train)
summary(m11)
m11 <- lm(y_trans ~ Total.price.for.out.of.state.students.living.off.campus..not.with.family. +
full.time.retention.rate +
Tuition.and.fees + Average.9.month.salary.full.time.professors +
Average.amount.of.federal..state..local.or.institutional.grant.aid.received + Total.priceSQ, data=train)
summary(m11)
full.time.retention.rate + full.time.undergraduate.enrollment
Tuition.and.fees + Average.9.month.salary.full.time.professors +
Average.amount.of.federal..state..local.or.institutional.grant.aid.received + Total.priceSQ, data=train)
summary(m11)
plot(train$full.time.undergraduate.enrollment, m11$residuals)
library(car)
install.packages("car")
library(car)
?car
vif(m11)
summary(m11)
m11 <- lm(y_trans ~ Total.price.for.out.of.state.students.living.off.campus..not.with.family. +
full.time.retention.rate + full.time.undergraduate.enrollment
Tuition.and.fees + Average.9.month.salary.full.time.professors +
Average.amount.of.federal..state..local.or.institutional.grant.aid.received , data=train)
summary(m11)
vif(m11)
m11 <- lm(y_trans ~ Total.price.for.out.of.state.students.living.off.campus..not.with.family. +
full.time.retention.rate + full.time.undergraduate.enrollment
Tuition.and.fees + Average.9.month.salary.full.time.professors +
Average.amount.of.federal..state..local.or.institutional.grant.aid.received , data=train)
m11 <- lm(y_trans ~ Total.price.for.out.of.state.students.living.off.campus..not.with.family. +
full.time.retention.rate + full.time.undergraduate.enrollment +
Tuition.and.fees + Average.9.month.salary.full.time.professors +
Average.amount.of.federal..state..local.or.institutional.grant.aid.received , data=train)
summary(m11)
vif(m11)
shiny::runApp('Shiny/Batting')
devtools::install_github("rstudio/shinydashboard")
shiny::runApp('Shiny/Batting')
shiny::runApp('Shiny/Batting')
shiny::runApp('Shiny/Batting')
shiny::runApp('Shiny/Batting')
shiny::runApp('Shiny/Batting')
shiny::runApp('GitHub/Batting')
m9 <- lm(y_trans ~ Total.price.for.in.state.students.living.off.campus..not.with.family. + full.time.retention.rate +
Total.priceSQ + Total.enrollment + Applicants.men, data=train)
summary(m9)
m11 <- lm(y_trans ~ Total.price.for.out.of.state.students.living.off.campus..not.with.family. +
full.time.retention.rate + full.time.undergraduate.enrollment +
Tuition.and.fees + Average.9.month.salary.full.time.professors +
Average.amount.of.federal..state..local.or.institutional.grant.aid.received , data=train)
summary(m11)
m11 <- lm(y_trans ~
full.time.retention.rate + full.time.undergraduate.enrollment +
Tuition.and.fees + Average.9.month.salary.full.time.professors +
Average.amount.of.federal..state..local.or.institutional.grant.aid.received , data=train)
summary(m11)
vif(m11)
library(car)
vif(m11)
plot(m8$fitted.values, m8$residuals)
plot(train$full.time.undergraduate.enrollment, m11$residuals)
plot(train$full.time.retention.rate, m11$residuals)
plot(train$Student.to.faculty.ratio, m11$residuals)
plot(train$Average.9.month.salary.full.time.professors, m11$residuals)
shiny::runApp('Shiny/Batting')
appliance$BUYPROP
sqrt(appliance$BUYPROP)
asin(sqrt(appliance$BUYPROP))
library(Lahman)
hofChart = function(pitcher, stat){
require(doBy)
require(ggplot2)
# season totals by pitcher
Pitching = summaryBy(ER + IPouts + SO + BB ~ playerID + yearID
, data=Pitching, FUN=sum, keep.names=T)
# calculate stats (you can add your own too, e.g.: HR/9, FIP, ...)
Pitching$ERA = Pitching$ER * 27 / Pitching$IPouts
Pitching$K9 = Pitching$SO * 27 / Pitching$IPouts
Pitching$W9 = Pitching$BB * 27 / Pitching$IPouts
# get selected pitcher's data
pitID = subset(Master, paste(nameFirst, nameLast)==pitcher)$playerID
pitData = subset(Pitching, playerID==pitID)
# get contemporaries of selected pitcher (qualifying only)
contemporaries = subset(Pitching
, yearID >= min(pitData$yearID)
& yearID <= max(pitData$yearID)
& IPouts >= 162*3)
# compare stat with contemporaries
ggplot(data=pitData, aes_string(x="factor(yearID)", y=stat)) +
geom_boxplot(data=contemporaries, aes_string(x="factor(yearID)", y=stat)) +
geom_point(data=contemporaries, aes_string(x="factor(yearID)", y=stat, col="'oth'", shape="'oth'", size="'oth'"), position=position_jitter(width = 0.15), alpha=.6) +
geom_point(aes(col="sel", shape="sel", size="sel")) +
xlab("season") +
ggtitle(paste(pitcher, " vs his contemporaries (", stat, ")", sep="")) +
scale_color_manual(values=c("oth"="black", "sel"="blue")
, labels=c("oth"="contemporaries", "sel"=pitcher)
, name="") +
scale_shape_manual(values=c("oth"=1, "sel"=19)
, labels=c("oth"="contemporaries", "sel"=pitcher)
, name="") +
scale_size_manual(values=c("oth"=2, "sel"=5)
, labels=c("oth"="contemporaries", "sel"=pitcher)
, name="")
}
hofChart("Cole Hamels", "ERA")
hofChart("Cole Hamels", "K9")
ncaa <- paste("https://www.dropbox.com/s/pappjoov6ozvvf0/ncaa.csv?dl=0")
head(ncaa)
ncaa
ncaa <- paste("https://www.dropbox.com/s/pappjoov6ozvvf0/ncaa.csv?dl=0")
ncaa <- repmis::source_data(ncaa, sep = ",", header = TRUE)
ncaa
library(ggvis)
library(dplyr)
ncaa <- paste("https://www.dropbox.com/s/pappjoov6ozvvf0/ncaa.csv?dl=0")
ncaa <- repmis::source_data(ncaa, sep = ",", header = TRUE)
ncaa$id <- 1:nrow(ncaa)
all_values <- function(x) {
if(is.null(x)) return(NULL)
paste0(ncaa$Team[x$id],
"<br>",
ncaa$Record[x$id]
)
}
```{r}
ungroup() %>%
layer_points(size := 40, size.hover := 200, fill = ~Team, key:=~id) %>%
```
ncaa  %>%
properties = axis_props(
add_axis("x", orient = "top", ticks = 0, title = "NCAA Men's Basketball AP Top 10",
layer_lines(stroke.hover = ~Team, strokeWidth.hover := 8, strokeWidth := 1) %>%
ggvis(~Week,~Rank, stroke = ~Team) %>%
axis = list(stroke = "white"),
labels = list(fontSize = 0))) %>%
add_axis("x", title="Week",  subdivide = 0, values = seq(1, 18, by = 1), format="####") %>%
add_axis("y", title="Rank", subdivide = 0, values = seq(1, 10, by = 1), format='####') %>%
scale_numeric("y", reverse=TRUE) %>%
add_tooltip(all_values, "hover")
ncaa$id <- 1:nrow(ncaa)
all_values <- function(x) {
if(is.null(x)) return(NULL)
paste0(ncaa$Team[x$id],
"<br>",
ncaa$Record[x$id]
)
}
ncaa  %>%
ungroup() %>%
ggvis(~Week,~Rank, stroke = ~Team) %>%
layer_points(size := 40, size.hover := 200, fill = ~Team, key:=~id) %>%
layer_lines(stroke.hover = ~Team, strokeWidth.hover := 8, strokeWidth := 1) %>%
add_axis("x", orient = "top", ticks = 0, title = "NCAA Men's Basketball AP Top 10",
properties = axis_props(
axis = list(stroke = "white"),
labels = list(fontSize = 0))) %>%
add_axis("x", title="Week",  subdivide = 0, values = seq(1, 18, by = 1), format="####") %>%
add_axis("y", title="Rank", subdivide = 0, values = seq(1, 10, by = 1), format='####') %>%
scale_numeric("y", reverse=TRUE) %>%
add_tooltip(all_values, "hover")
library(ggplot2)
library(MASS)
library(ellipse)
library(corrgram)
library(car)
education <- read.csv("~/DePaul/CSC423_Regression/edu.csv")
education <- subset(education, education$Graduation.rate.men != 0)
education$Graduation.rate.men <- education$Graduation.rate.men/100
education <- na.omit(education)
names(education)
set.seed(123)
sample.size <- floor(0.7*nrow(education))
train.ind <- sample(seq_len(nrow(education)), size=sample.size)
train <- education[train.ind, ]
test <- education[-train.ind, ]
sqrt(train$Graduation.rate.men)
asin(sqrt(train$Graduation.rate.men))
train$y_trans <- log(train$Graduation.rate.men)
train$Total.priceSQ <- train$Total.price.for.in.state.students.living.off.campus..not.with.family. ** 2
train$ProfSQ <- train$Average.9.month.salary.full.time.professors ** 2
m9 <- lm(y_trans ~ Total.price.for.in.state.students.living.off.campus..not.with.family. + full.time.retention.rate +
Total.priceSQ + Total.enrollment + Applicants.men, data=train)
summary(m9)
m10 <- lm(y_trans ~ . - Graduation.rate.total.cohort - unitid - institution.name - year - City.location.of.institution - State.abbreviation
- Highest.level.of.offering - Institution.size.category - Bachelors.degree.awarded - Graduation.rate.American.Indian.or.Alaska.Native -
Graduation.rate.Black.non.Hispanic - Graduation.rate.Black.non.Hispanic - Graduation.rate.White.non.Hispanic -
Graduation.rate.women - Graduation.rate.Asian - Graduation.rate.Hispanic -
Number.of.students.receiving.a.Bachelors.degree - Graduation.rate.Asian.Native.Hawaiian.Other.Pacific.Islander -
Bachelors.degree - Graduation.rate.men, data=train)
step <- stepAIC(m10, direction='backward')
m11 <- lm(y_trans ~  full.time.retention.rate + full.time.undergraduate.enrollment +
Tuition.and.fees + Average.9.month.salary.full.time.professors +
Average.amount.of.federal..state..local.or.institutional.grant.aid.received , data=train)
summary(m11)
plot(m8$fitted.values, m8$residuals)
plot(train$full.time.undergraduate.enrollment, m11$residuals)
plot(train$full.time.retention.rate, m11$residuals)
plot(train$Student.to.faculty.ratio, m11$residuals)
plot(train$Average.9.month.salary.full.time.professors, m11$residuals)
plot(train$full.time.retention.rate, m11$residuals)
plot(train$full.time.retention.rate, m11$residuals)
plot(train$Student.to.faculty.ratio, m11$residuals)
plot(m8$fitted.values, m8$residuals)
plot(train$full.time.undergraduate.enrollment, m11$residuals)
getwd()
plot(train$full.time.undergraduate.enrollment, m11$residuals)
plot(m8$fitted.values, m8$residuals)
plot(train$full.time.undergraduate.enrollment, m11$residuals)
plot(train$full.time.retention.rate, m11$residuals)
plot(train$Student.to.faculty.ratio, m11$residuals)
plot(train$Average.9.month.salary.full.time.professors, m11$residuals)
plot(m8$fitted.values, m8$residuals)
plot(train$full.time.undergraduate.enrollment, m11$residuals)
plot(train$full.time.retention.rate, m11$residuals)
plot(train$Student.to.faculty.ratio, m11$residuals)
shiny::runApp('GitHub/Spray Chart')
